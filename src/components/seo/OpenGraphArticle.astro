---
/**
 * @name OpenGraphArticle
 * Component used to build out the article open graph meta tags.
 *
 * @return {Function} an Astro component factory function.
 *
 * @example
 * <OpenGraphArticle published={article.published} modified={article.modified} authorId={article.author.id} ... />
 */
import slugify from "@sindresorhus/slugify"
import type { CollectionEntry } from "astro:content"
import OpenGraphBasic from "./OpenGraphBasic.astro"
import OpenGraphImage from "./OpenGraphImage.astro"

interface Props {
  article: CollectionEntry<"article">
  site: CollectionEntry<"site">
}

const { article, site } = Astro.props
const data = article.data
const modifiedDate = data.modified || data.published
const baseUrl = import.meta.env.SITE
---

<OpenGraphBasic
  title={data.title}
  description={data.description}
  path={`${baseUrl}/article/${article.slug}`}
  type={"article"}
  site={site}
/>
<OpenGraphImage
  image={data.featured.image}
  imageAlt={data.featured.author ? data.featured.author.name : "unknown"}
/>
<meta property="article:published_time" content={data.published.toISOString()} />
<meta property="article:modified_time" content={modifiedDate.toISOString()} />
<meta property="article:author" content={`${baseUrl}/author/${slugify(data.author.id)}`} />
<meta property="article:section" content={data.category} />
{data.tags.map((tag: string) => <meta property="article:tag" content={tag} />)}
